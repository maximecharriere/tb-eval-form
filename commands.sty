\newcommand{\infosheader}[6]{
    \begin{tabularx}{\textwidth}{|l|X|l|l|} \hline
        \textbf{Professeur}                 & #1
                                            & \textbf{Date}           & #2                                 \\
        \hline
        \textbf{Titre du projet}            & \multicolumn{3}{l|}{#3}                                      \\
        \hline
        \multirow{2}{*}{\textbf{Étudiants}} & \textbf{Nom}            & \textbf{Prénom} & \textbf{Filière} \\
                                            & #4                      & #5              & #6               \\
        [2cm] \hline
    \end{tabularx}
}

\newcommand\weight[2]{%
    \TextField[
        maxlen=2,align=1,height=10pt,width=1.5cm,name=#1,default=#2,
        format={AFNumber_Format\string\(0, 2, 0, 0, "\%", false \string\);}]{}
}

\newcommand\score[1]{%
    \TextField[
        maxlen=3,align=1,height=10pt,width=1.5cm,name=#1,default=1.0,
        calculate={%
                event.value = Math.min(6.0, Math.max(1.0, this.getField('#1').value))
            },
        format={AFNumber_Format\string\(1, 2, 0, 0, "", false \string\);}]{}
}

\newcommand\porg{%
    \TextField[maxlen=2,align=1,height=10pt,width=1.5cm,name=p1,
        calculate={%
                event.value =
                this.getField("p2").value +
                this.getField("p3").value +
                this.getField("p4").value +
                this.getField("p5").value +
                this.getField("p6").value
            },readonly=true,format={AFNumber_Format\string\(0, 2, 0, 0, "\%", false \string\);}]{}
}

\newcommand\sorg{%
    \TextField[maxlen=2,align=1,height=10pt,width=1.5cm,name=n1,
        calculate={%
                event.value = (
                this.getField("p2").value * this.getField("n2").value +
                this.getField("p3").value * this.getField("n3").value +
                this.getField("p4").value * this.getField("n4").value +
                this.getField("p5").value * this.getField("n5").value +
                this.getField("p6").value * this.getField("n6").value)
                / this.getField("p1").value
            }, readonly=true,
        format={AFNumber_Format\string\(1, 2, 0, 0, "", false \string\);}]{}
}

\newcommand\pcom{%
    \TextField[maxlen=2,align=1,height=10pt,width=1.5cm,name=p7,
        calculate={%
                event.value =
                this.getField("p8").value +
                this.getField("p9").value
            },readonly=true,
        format={AFNumber_Format\string\(0, 2, 0, 0, "\%", false \string\);}]{}
}

\newcommand\scom{%
    \TextField[maxlen=2,align=1,height=10pt,width=1.5cm,name=n7,
        calculate={%
                event.value = (
                this.getField("p8").value * this.getField("n8").value +
                this.getField("p9").value * this.getField("n9").value)
                / this.getField("p7").value
            }, readonly=true,
        format={AFNumber_Format\string\(1, 2, 0, 0, "", false \string\);}]{}
}

\newcommand\hs{\hspace{2em}}
\newcommand\tr{\rowcolor{lightgray}}